<!DOCTYPE html>
<html lang="en">
    {% extends 'medrec/base.html' %}
    
    {% block content %}
    <head>
        <head>
            {% load crispy_forms_tags %}
            {% load static %}
            <meta charset="UTF-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Document</title>
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
            <link rel="stylesheet" href="{% static 'css/base.css' %}">
            <link rel="stylesheet" href="{% static 'css/bill.css' %}">
            <link rel="stylesheet" href="{% static 'css/demo.css' %}">
            <link rel="stylesheet" href="{% static 'css/note.css' %}">
            <link rel="stylesheet" href="{% static 'css/plan.css' %}">
            <link rel="stylesheet" href="{% static 'css/s_o.css' %}">
            <link rel="stylesheet" href="{% static 'css/vital.css' %}">
            <script defer src="{% static 'js/app.js'%}"></script>
            
        </head>
        <body> 
        <div>
            <hr>
                    <p style="text-align:center"><span>Search Patient: 
                        <input type="text">
                        <input type="submit">
                    </span></p> 
                    <hr>
                    <h3 style="text-align:center;">Patients Demographic</h3>
                    <div class="demo">
                        
                        <div class="pt_pic">
                            
                            <div class="card" style="width: 18rem;">
                                <img src="..." class="card-img-top" alt="...">
                                <div class="card-body">
                                  <h5 class="card-title">About Me</h5>
                                  <p class="card-text">Its My Time to Shine</p>
                                  <button>Submit</button> <button>Update</button> <button>Add</button>
                                  <a href="#" class="btn btn-primary">See More</a>
                                </div>
                              </div>
                        </div>
                        <div class="demo_info">
                            <div class="card" style="width: 18rem;">
                                <h6>My Information</h6>
                                <ul class="list-group list-group-flush">
                                  <li class="list-group-item">Name:</li>
                                  <li class="list-group-item">Identity Number:</li>
                                  <button>Submit</button> <button>Update</button> <button>Add</button>
                                  <a href="#" class="btn btn-primary">See More</a>
                                </ul>
                              </div>
                        </div>
                        <div class="hedi_meas">
                            <div class="card" style="width: 18rem;">
                                <h6>Am at Risk For</h6>
                                <ul class="list-group list-group-flush">
                                  <li class="list-group-item">Diabetes</li>
                                  <li class="list-group-item">Cancer:</li>
                                  <button>Submit</button> <button>Update</button> <button>Add</button>
                                  <a href="#" class="btn btn-primary">See More</a>
                                </ul>
                              </div>

                        </div>
                        <div class="chron_hx">
                            <div class="card" style="width: 18rem;">
                                <h6>My Medical History</h6>
                                <ul class="list-group list-group-flush">
                                  <li class="list-group-item">Obesity</li>
                                  <li class="list-group-item">Tuberculosis</li>
                                  <button>Submit</button> <button>Update</button> <button>Add</button>
                                  <a href="#" class="btn btn-primary">See More</a>
                                </ul>
                              </div>

                        </div>
                    </div>
            <hr>
            <h3 style="text-align:center">Vital Signs</h3>
            <div class="row">
                <div class="col-sm-3">
                  <div class="card">
                    <div class="card-body">
                      <h5 class="card-title">Physical Attributes</h5>
                      <ul class="list-group list-group-flush">
                        <li class="list-group-item">Height: </li>
                        <li class="list-group-item">Weight:</li>
                        <button>Submit</button> <button>Update</button> <button>Add</button>
                        <a href="#" class="btn btn-primary">See More</a>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-sm-3">
                  <div class="card">
                    <div class="card-body">
                      <h5 class="card-title">Vital Signs</h5>
                      <ul class="list-group list-group-flush">
                        <li class="list-group-item">Blood Pressure: </li>
                        <li class="list-group-item">Pulse:</li>
                        <button>Submit</button> <button>Update</button> <button>Add</button>
                        <a href="#" class="btn btn-primary">See More</a>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-sm-3">
                    <div class="card">
                      <div class="card-body">
                        <h5 class="card-title">Pain Status</h5>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">Alert and Oriented</li>
                            <li class="list-group-item">No Acute Distress</li>
                            <button>Submit</button> <button>Update</button> <button>Add</button>
                            <a href="#" class="btn btn-primary">See More</a>
                          </ul>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-3">
                    <div class="card">
                      <div class="card-body">
                        <h5 class="card-title">Other</h5>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">PERRLA</li>
                            <li class="list-group-item">CTA</li>
                            <button>Submit</button> <button>Update</button> <button>Add</button>
                            <a href="#" class="btn btn-primary">See More</a>
                          </ul>
                        
                      </div>
                    </div>
                  </div>
              </div>

            <hr>
                    <h3 style="text-align:center;">Subjective and Objective</h3>
                    <div class="row row-cols-1 row-cols-md-2 g-3">
                        <div class="col">
                          <div class="card h-100">
                            <div class="card-body">
                              <h5 class="card-title">What is Wrong with Me</h5>
                              <p class="card-text">'I coughed once and am scared I might have a broken leg'</p>
                            </div>
                            <div class="card-footer">
                                <button>Submit</button> <button>Update</button> <button>Add</button>
                                <a href="#" class="btn btn-primary">See More</a>
                                  <small class="text-muted">{Last updated 3 mins ago}</small>
                            </div>
                          </div>
                        </div>
                        <div class="col">
                          <div class="card h-100">
                            <div class="card-body">
                              <h5 class="card-title">What the Doctor Observed</h5>
                              <p class="card-text">Cry Baby.</p>
                            </div>
                            <div class="card-footer">
                                <button>Submit</button> <button>Update</button> <button>Add</button>
                            <a href="#" class="btn btn-primary">See More</a>
                              <small class="text-muted">{Last updated 3 mins ago}</small>
                            </div>
                          </div>
                        </div>
                        
                      </div>

            <hr>
                    <div class="plan">
                        <div class="assessment_tabs">
                            <input type="radio" id="as_tab" name="assessment_tabs" checked="checked">
                            <label for="as_tab">Diagnosis</label>
                            <div class="tab">
                                <div id="app">
                                    <h1>Get Codes</h1>
                                    <form @submit.prevent="getCodes">
                                        <div>
                                            <input type="search" class="form-control" v-model="query" placeholder="Search ICD Codes">
                                            <button class="btn btn-success">Search</button>
                                        </div>
                                    </form>
                                    <form action="">
                                        
                                        <select name="" id="" @click="getCode()">
                                            <option v-for="(icd,index) in data" :key="index">
                                                [[icd]]
                                            </option>
                                        </select>
                                        <button id="id_diagnosis" class="btn btn-danger">Submit</button>   
                                    </form>

                                    <form action="" id="code-form">
                                        <div>
                                               {% csrf_token %}
                                               
                                               {% for field in form  %}
                                               
                                                   <label class="col-12">{{field.label}}</label>
                                                   {{field}}
                                               {% endfor %}
                                               <button class="btn btn-danger">Save</button>
                                           </div>
                                       </form>

                                </div>
                                
                                        
                            </div>
                            <input type="radio" id="lab_tab" name="assessment_tabs">
                            <label for="lab_tab">Laboratory</label>
                            <div class="tab">
                                <h3>Laboratory</h3>
                                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. A tempora inventore dolores magni, quaerat asperiores. Perferendis accusamus vitae, aspernatur modi earum voluptatum deserunt quod quaerat blanditiis tenetur alias cupiditate nulla.</p>
                            </div>
                    
                            <input type="radio" id="rad_tab" name="assessment_tabs">
                            <label for="rad_tab">Radiology</label>
                            <div class="tab">
                                <h3>Radiology</h3>
                                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. A tempora inventore dolores magni, quaerat asperiores. Perferendis accusamus vitae, aspernatur modi earum voluptatum deserunt quod quaerat blanditiis tenetur alias cupiditate nulla.</p>
                            </div>
            
                            <input type="radio" id="phar_tab" name="assessment_tabs">
                            <label for="phar_tab">Pharmacy</label>
                            <div class="tab">
                                <h3>Pharmacy</h3>
                                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. A tempora inventore dolores magni, quaerat asperiores. Perferendis accusamus vitae, aspernatur modi earum voluptatum deserunt quod quaerat blanditiis tenetur alias cupiditate nulla.</p>
                            </div>
            
                            <input type="radio" id="plan_tab" name="assessment_tabs">
                            <label for="plan_tab">Plan</label>
                            <div class="tab">
                                
                                <div>
                                    <h3>Medical Problems</h3>
                                    
                                    <div class="container-fluid">
                                        <table class="table table-striped table-sm" id="the_icd_codes">
                                            
                                            <tbody>
                                            {% for icdcodes in code_forms %}
                                            <tr>
                                                <td>{{icdcodes.diagnosis}}</td>
                                                
                                            </tr>
                                            {% endfor %}
                                            </tbody>
                                        </table>
                                    
                                    </div>
                                </div>
                                <p>Laboratory</p>
                                <p>Radiology</p>
                                <p>Medications</p>
                                <p>Plan</p>
                            </div>
                        </div>
                    </div>
                    </div>
            <hr>
<div class="card-footer" style="text-align: center;">

<button>Submit Note</button> <button>Update Note</button> <button>Delete Note</button>
<small class="text-muted">Note signed on {date} by {Doctor}</small>
</div>
            <hr>
                    <div class="billing">
                        <h2 style="text-align: center;">Patients Bill</h2>
                        <form action="">
                            <p style="justify-content:space-around">
                                <label for="">Diagnosis:</label>
                                <input type="text" placeholder="Diagnosis">
                                <input type="number" placeholder="cost">
                                <button>Submit</button>
            
                                <label for="">Medication:</label>
                                <input type="text" placeholder="Medication">
                                <input type="number" placeholder="cost">
                                <button>Submit</button>
                            </p>
                            <p style="justify-content:space-around">
                                <label for="">Laboratory:</label>
                                <input type="text" placeholder="Laboratory">
                                <input type="number" placeholder="cost">
                                <button>Submit</button>
                                
                                <label for="">Radiology:</label>
                                <input type="text" placeholder="Radiology">
                                <input type="number" placeholder="cost">
                                <button>Submit</button>
                            </p>
                            <p>
                                <label for="">Total:</label>
                                <input type="number" placeholder="Total">
                            </p>
                            
                        </form>
                        <button class="btn btn-danger">Submit</button>
            
                    </div>
            
                </div>
        
                <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.27.2/axios.min.js" integrity="sha512-odNmoc1XJy5x1TMVMdC7EMs3IVdItLPlCeL5vSUPN2llYKMJ2eByTTAIiiuqLg+GdNr9hF6z81p27DArRFKT7A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
                <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js'></script>
                <script src='https://clinicaltables.nlm.nih.gov/autocomplete-lhc-versions/17.0.2/autocomplete-lhc.min.js'></script>
                <script>
                    var app = new Vue({
                        delimiters: ['[[',']]'],
                        el: '#app',
                        data() {
                            return {
                                query: '',
                                data:[]
                    }
                            
                        },
                        methods: {
                            async getCodes(){
                                await axios.get(`https://clinicaltables.nlm.nih.gov/api/icd10cm/v3/search?sf=code,name&terms=${this.query}`)
                                .then((response)=>{
                                    this.data = response.data[3]
                                    console.log(this.data)
                                })
                                .catch((error)=>{
                                    console.log(error)
                                })
                            },
                            
        
                        },
                        

                        created: function() {
        
                        }
                    })
                </script>
                <script>
                    /*
                        On submiting the form, send the POST ajax
                        request to server and after successfull submission
                        display the object.
                    */
                    $("#code-form").submit(function (e) {
                        // preventing from page reload and default actions
                        e.preventDefault();
                        // serialize the data for sending the form data.
                        var serializedData = $(this).serialize();
                        // make POST ajax call
                        $.ajax({
                            type: 'POST',
                            url: "{% url 'post_code' %}",
                            data: serializedData,
                            success: function (response) {
                                // on successfull creating object
                                // 1. clear the form.
                                $("#code-form").trigger('reset');
                                // 2. The diagnosis code
                                $("#id_diagnosis").focus();
                
                                
                                var instance = JSON.parse(response["instance"]);
                                var fields = instance[0]["fields"];
                                $("#the_icd_codes tbody").prepend(
                                    `<tr>
                                    <td>${fields["diagnosis"]||""}</td>
                                    </tr>`
                                )
                            },
                            error: function (response) {
                                // alert the error if any error occured
                                alert(response["responseJSON"]["error"]);
                            }
                        })
                    })

                    
                </script>
                
        
        
        </body>
        
        {% endblock content %}
        
</html>
        



